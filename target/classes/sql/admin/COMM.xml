<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="COMM">
	<select id="getMenu" parameterType="HashMap" resultType="HashMap">
		SELECT
			  A.NAME
			, B.LINK || A.LINK AS LINK
			, A.MENULEVEL
		FROM
			MENU A JOIN CATEGORY B ON A.CATEGORYCODE = B.CODE 
		WHERE 1=1
			AND A.USEYN = 'Y'
			<if test="menuLevel == 0">
			AND A.PARENTCODE IS NULL
			</if>
			<if test="menuLevel != 0">
			AND A.PARENTCODE IS NOT NULL
			</if>
	</select>
	
	<select id="getAdminMenuList" parameterType="HashMap" resultType="HashMap">
		SELECT
				*
		FROM (
				SELECT
						  A.*
						, ROWNUM AS RNUM
						, COUNT (*) OVER() AS TOTCONT
				FROM (
						SELECT
							  SEQ
							, MENUNAME
							, MENULEVEL
							, MENUCATEGORY
							, MENULINK
							, MENUAUTH
							, USEYN
						FROM 
							MENU
						WHERE 1=1	
						AND MENUGBN ='A'
						ORDER BY SEQ ASC
					) A
			)
    	WHERE 1=1
    		<![CDATA[
    			AND RNUM >= #{startCount} AND RNUM <= #{endCount}
    		]]>
	</select>
</mapper>